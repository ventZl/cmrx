<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C Microkernel Realtime eXecutive: SysTick-Based Timing Provider</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="all">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">C Microkernel Realtime eXecutive
   </div>
   <div id="projectbrief">Realtime Operating System for Cortex-M based microcontrollers</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__aux__systick.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">SysTick-Based Timing Provider<div class="ingroups"><a class="el" href="group__libs.html">Libraries</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>This is auxiliary implementation of <a class="el" href="group__api__timing.html">Timing provider API</a> using ARM SysTick.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gac72eb3fe338346006ca3089ca0898867" id="r_gac72eb3fe338346006ca3089ca0898867"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__aux__systick.html#gac72eb3fe338346006ca3089ca0898867">timing_provider_setup</a> (int interval_ms)</td></tr>
<tr class="memdesc:gac72eb3fe338346006ca3089ca0898867"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the timing provider.  <br /></td></tr>
<tr class="separator:gac72eb3fe338346006ca3089ca0898867"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1f3beb37c30fe05a0e3f9c30dae2de2" id="r_gac1f3beb37c30fe05a0e3f9c30dae2de2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__aux__systick.html#gac1f3beb37c30fe05a0e3f9c30dae2de2">sys_tick_handler</a> ()</td></tr>
<tr class="memdesc:gac1f3beb37c30fe05a0e3f9c30dae2de2"><td class="mdescLeft">&#160;</td><td class="mdescRight">SysTick interrupt handler.  <br /></td></tr>
<tr class="separator:gac1f3beb37c30fe05a0e3f9c30dae2de2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa382f230650e9c08f3d5dec13da6fbd4" id="r_gaa382f230650e9c08f3d5dec13da6fbd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__aux__systick.html#gaa382f230650e9c08f3d5dec13da6fbd4">timing_provider_schedule</a> (long <a class="el" href="group__os__timer.html#ga5a54481fa8804be03b96cbc5d85ec03b">delay_us</a>)</td></tr>
<tr class="memdesc:gaa382f230650e9c08f3d5dec13da6fbd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Schedule next timer callback to kernel.  <br /></td></tr>
<tr class="separator:gaa382f230650e9c08f3d5dec13da6fbd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>This is auxiliary implementation of <a class="el" href="group__api__timing.html">Timing provider API</a> using ARM SysTick. </p>
<p>This file can serve both as an example of how to implement timing provider and also serve as quick bootstrap timing provider for your project. You'll have to replace it if you want to either go tickless or implement power management.</p>
<p>This implementation uses SysTick Cortex-M peripheral available on virtually all ARM Cortex-M microcontrollers. The implementation here is a simple timer that fires periodically. This will disable kernel's tickless feature. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="gac1f3beb37c30fe05a0e3f9c30dae2de2" name="gac1f3beb37c30fe05a0e3f9c30dae2de2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac1f3beb37c30fe05a0e3f9c30dae2de2">&#9670;&#160;</a></span>sys_tick_handler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sys_tick_handler </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SysTick interrupt handler. </p>
<p>This ISR serves SysTick interrupt. It contains a counter, how many more interrupts have to happen before kernel gets called. If counter reaches zero, then kernel is called. Return value from kernel denotes next delay before kernel shall be called again. If that value is zero, then systick timer is disabled. Otherwise the counter is restored with new value and cycle repeats again.</p>
<p>Different timing provider may choose to use different clock provider, or even providers and decide, that it will put CPU into sleep mode, if delay is too long, or there is no expected timed wake-up. If timing provider behaves as this, it is integrator's responsibility to ensure, that external interrupts, or whatever other sources of events are enabled in sleep state, which the timing provider will enter.</p>
<p>Kernel never calls this function on its own. Integrator may use whatever means of triggering the timer appropriate for given hardware. Whatever implementation provided must call kernel callback <a class="el" href="group__api__timing.html#gad2eee99d75e6b65c227f65a6880f2e9f">os_sched_timing_callback</a> from kernel-equivalent context. </p>

</div>
</div>
<a id="gaa382f230650e9c08f3d5dec13da6fbd4" name="gaa382f230650e9c08f3d5dec13da6fbd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa382f230650e9c08f3d5dec13da6fbd4">&#9670;&#160;</a></span>timing_provider_schedule()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timing_provider_schedule </td>
          <td>(</td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>delay_us</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Schedule next timer callback to kernel. </p>
<p>Re-configure timing provider so that next timed kernel call will happen after given delay. This is the only function, whose implementation is mandatory and whose prototype nor behavior cannot be changed. If kernel calls this function, then timing provider must reconfigure itself so that it will be able to call back to the kernel as close as possible to time <a class="el" href="group__os__timer.html#ga5a54481fa8804be03b96cbc5d85ec03b">delay_us</a> microseconds in the future. This must happen even if kernel previously signalized that there is no expected timed event and timers were turned off entirely. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">delay_us</td><td>delay time, in microseconds after which kernel shall be called by the timing provider. The value of 0 means that timing provider should not trigger the kernel timer callback until further notice. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function is guarranteed to be called from kernel context. </dd></dl>

</div>
</div>
<a id="gac72eb3fe338346006ca3089ca0898867" name="gac72eb3fe338346006ca3089ca0898867"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac72eb3fe338346006ca3089ca0898867">&#9670;&#160;</a></span>timing_provider_setup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timing_provider_setup </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>interval_ms</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the timing provider. </p>
<p>This function shall be called by the main() function during hardware bringup. Its purpose is to configure whatever peripheral or combination of peripherals that provides kernel timing services. These peripherals shall be configured and prepared, but not launched yet.</p>
<p>Kernel never calls this function on its own. The prototype of this function can be modified by the integrator to suit all the needs.</p>
<p>This function shall be called before the <a class="el" href="group__os.html#gac0d275303ced3f7617b7d71fd1464687">os_start()</a> function is called and can therefore be called in any suitable context.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">interval_ms</td><td>how often the systick ISR shall be called. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</div>
</body>
</html>
