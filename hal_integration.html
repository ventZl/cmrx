<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C Microkernel Realtime eXecutive: Integrating vendor SDKs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="all">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">C Microkernel Realtime eXecutive
   </div>
   <div id="projectbrief">Realtime Operating System for Cortex-M based microcontrollers</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('hal_integration.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Integrating vendor SDKs</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>As mentioned before, CMRX does not provide any OS-specific HAL or SDK. You have to integrate vendor-provided HAL. This way, the use of CMRX is as non-intrusive as technically possible. CMRX itself - being a microkernel - uses only minimalistic set of peripherals, almost exclusively only peripherals residing on Cortex core itself. Only architecture dependent part of the kernel code is ever using these peripherals. This part is always written with some HAL in mind. For example the default ARM port is written using CMSIS standard. CMSIS standard is quite broad but minimalistic needs of CMRX kernel can usually be satisfied by the basic CMSIS device header. This header is often present in vendor SDK for a microcontroller in some form usable by the CMRX.</p>
<p>Second part usually present in the vendor SDK is the linker script for your target device which declares base addresses of RAM and FLASH and defines regions for code, data, bss and others. This script is needed to link the binary correctly. CMRX needs this scriupt to be manipulated in order to enable memory protection.</p>
<p>Third part of vendor SDK are the startup and system source files. They might or might not be present, or may be present in slightly different organization. Here vendors are creative and mostly ignore CMSIS standard.</p>
<p>As long as the CMRX kernel itself is concerned, this is all that is needed from the vendor SDK. Your application's need will usually be bigger as you might want to use peripheral drivers and utility libraries provided by the SDK. While the range and way of using these vary from project to project, CMRX does not deal with these at all. It is up to integrator to include them into project.</p>
<h2><a class="anchor" id="autotoc_md61"></a>
CMSIS helper</h2>
<p>To make integration of CMSIS HAL for needs of the CMRX easier, there is small CMake module which helps to find various CMSIS components and set up defines. This module is called <code>FindCMSIS.cmake</code>. This module will determine include paths for core CMSIS headers and try to find startup and system components of CMSIS, if available. It will copy the linker file to location CMRX expects to find one.</p>
<p>The basic use of <code>FindCMSIS</code> is like:</p>
<div class="fragment"><div class="line">set(CMSIS_ROOT &lt;path to where CMSIS is located in vendor SDK&gt;)</div>
<div class="line">set(DEVICE &lt;device name recognized by the vendor SDK&gt;)</div>
<div class="line">set(CMSIS_LINKER_FILE &lt;location of the linker file&gt;)</div>
<div class="line">include(FindCMSIS)</div>
</div><!-- fragment --><p>If necessary CMSIS components are found, then following is done:</p>
<ul>
<li>library <code>cmsis_core_lib</code> is created. This is an interface library that propagates include paths to all headers of CMSIS core. This ensures that the CMSIS headers can be included into CMRX source. ARM port based on CMSIS HAL expects this library to exist while compiling.</li>
<li>file <code>RTE_Components.h</code> is creates in <code>CMAKE_BINARY_DIR</code>. This file contains an alias to device file as per CMSIS specs, so the CMRX kernel code is device-independent. ARM port based on CMSIS HAL expects this file to exist.</li>
<li>linker file is copied into file named <code>gen.&lt;DEVICE&gt;.ld</code> into <code>CMAKE_BINARY_DIR</code>. This is where CMRX expects to find the device linker script. If linker script provided in variable <code>CMSIS_LINKER_FILE</code> does not exist, then FindCMSIS will fail with error.</li>
<li>variable <code>CMSIS_SRCS</code> is defined which contains list of files found that compose the CMSIS core. Only files named according to CMSIS specs are detected. These files are not handled automatically, rather it is the integrator's task to handle them in a way the vendor SDK is designed to do. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</div>
</body>
</html>
