<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C Microkernel Realtime eXecutive: Tracing Kernel Events</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="all">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">C Microkernel Realtime eXecutive
   </div>
   <div id="projectbrief">Realtime Operating System for Cortex-M based microcontrollers</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__os__tracing.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Tracing Kernel Events<div class="ingroups"><a class="el" href="group__os.html">Kernel documentation</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Facilities to trace progress of kernel execution.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga1a67c3beedf3da610b8c96abe49ac05a" id="r_ga1a67c3beedf3da610b8c96abe49ac05a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__tracing.html#ga1a67c3beedf3da610b8c96abe49ac05a">TraceEventID</a> { <br />
&#160;&#160;<a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aa939a6cc6d749a232a23ff324dca6d48c">EVENT_NONE</a> = 0
, <a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aac6181e793249436a2274fd96b5f8c480">EVENT_CPU_BOOT</a>
, <a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aaab0a38e53e8b657dd4ee6ef3c7ebe9f2">EVENT_THREAD_SWITCH</a>
, <a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aaccbb92d3a22e5a33befa90ade0116854">EVENT_SYSCALL</a>
, <br />
&#160;&#160;<a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aa78932add07a501da6c9d3a3815986512">EVENT_NOTIFY_WAIT_INIT</a>
, <a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aaad13956286543bf9ad96b89e50419a52">EVENT_NOTIFY_WAITING</a>
, <a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aafbc7782fce90f051b3bcb3f253c2c27a">EVENT_NOTIFY_PENDING</a>
, <a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aa4cf575f09ca098ca9ef15340587aa6a5">EVENT_WAIT_PENDING</a>
, <br />
&#160;&#160;<a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aa0b6feb861ea3eb9fa8a1550d06ef78a9">EVENT_WAIT_SUSPEND</a>
, <a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aa4996db8ea61862f6dc96648e3c97f292">EVENT_ISR_HANDLER</a>
, <a class="el" href="group__os__tracing.html#gga1a67c3beedf3da610b8c96abe49ac05aa0f68889b1009a9a0e10cfcb2511e5bb5">EVENT_KERNEL_TICK</a>
<br />
 }</td></tr>
<tr class="separator:ga1a67c3beedf3da610b8c96abe49ac05a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga098cdc49cfa2cfcfc59815e6978fddb8" id="r_ga098cdc49cfa2cfcfc59815e6978fddb8"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__tracing.html#ga098cdc49cfa2cfcfc59815e6978fddb8">trace_init</a> (void *start_addr, void *end_addr)</td></tr>
<tr class="memdesc:ga098cdc49cfa2cfcfc59815e6978fddb8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize trace buffer.  <br /></td></tr>
<tr class="separator:ga098cdc49cfa2cfcfc59815e6978fddb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac035534b8e50ba8942b8e6956268180c" id="r_gac035534b8e50ba8942b8e6956268180c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__os__tracing.html#gac035534b8e50ba8942b8e6956268180c">trace_event</a> (enum <a class="el" href="group__os__tracing.html#ga1a67c3beedf3da610b8c96abe49ac05a">TraceEventID</a> event, uint32_t arg)</td></tr>
<tr class="memdesc:gac035534b8e50ba8942b8e6956268180c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trace event.  <br /></td></tr>
<tr class="separator:gac035534b8e50ba8942b8e6956268180c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Facilities to trace progress of kernel execution. </p>
<p>Sometimes the current state of system as inspected by the debugger is not enough to fully understand what happens and why it happens. For these rough days the kernel tracing infrastructure offers facility to track certain events as they happened.</p>
<p>If tracing infrastructure is enabled by CMake option then tracing infrastructure support is built into kernel. This infrastructure is called from certain places. As of now tracing is all or nothing. Once tracing is enabled all trace events currently present in the code are recorded if they happen.</p>
<p>Trace buffer is a circular buffer that overwrites oldest recorded entries if new events are traced and the buffer is not large enough to store them.</p>
<h1><a class="anchor" id="os_tracing_enable"></a>
Enabling tracing</h1>
<p>In order for tracing to be active the developer needs to turn on CMake option named <code>CMRX_KERNEL_TRACING</code>. Then it is necessary to call function <a class="el" href="group__os__tracing.html#ga098cdc49cfa2cfcfc59815e6978fddb8">trace_init()</a> which will tell the tracing infrastructure where the tracing buffer can be stored.</p>
<p>Tracing buffer is not allocated normally, rather it is developer's task to find a suitable space outside of normally used memory where it can be placed.</p>
<p>This buffer will be "formatted" during the initialization and subsequent calls to <a class="el" href="group__os__tracing.html#gac035534b8e50ba8942b8e6956268180c">trace_event()</a> will record events there.</p>
<p>If buffer is not initialized then calls to <a class="el" href="group__os__tracing.html#gac035534b8e50ba8942b8e6956268180c">trace_event()</a> do nothing.</p>
<h1><a class="anchor" id="os_tracing_retrieving"></a>
Retrieving trace data</h1>
<p>Trace data is stored in RAM. In order to process them one has to dump them to the computer. This can be done in many ways. One possible way is to use the provided GDB script. This script is available in CMRX kernel repository in gdb/trace_log.gdb file. It provides dump_trace command. This command will dump trace in human readable form into file <code>trace.log</code> into current working directory. </p>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga1a67c3beedf3da610b8c96abe49ac05a" name="ga1a67c3beedf3da610b8c96abe49ac05a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1a67c3beedf3da610b8c96abe49ac05a">&#9670;&#160;</a></span>TraceEventID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__os__tracing.html#ga1a67c3beedf3da610b8c96abe49ac05a">TraceEventID</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aa939a6cc6d749a232a23ff324dca6d48c" name="gga1a67c3beedf3da610b8c96abe49ac05aa939a6cc6d749a232a23ff324dca6d48c"></a>EVENT_NONE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aac6181e793249436a2274fd96b5f8c480" name="gga1a67c3beedf3da610b8c96abe49ac05aac6181e793249436a2274fd96b5f8c480"></a>EVENT_CPU_BOOT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aaab0a38e53e8b657dd4ee6ef3c7ebe9f2" name="gga1a67c3beedf3da610b8c96abe49ac05aaab0a38e53e8b657dd4ee6ef3c7ebe9f2"></a>EVENT_THREAD_SWITCH&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aaccbb92d3a22e5a33befa90ade0116854" name="gga1a67c3beedf3da610b8c96abe49ac05aaccbb92d3a22e5a33befa90ade0116854"></a>EVENT_SYSCALL&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aa78932add07a501da6c9d3a3815986512" name="gga1a67c3beedf3da610b8c96abe49ac05aa78932add07a501da6c9d3a3815986512"></a>EVENT_NOTIFY_WAIT_INIT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aaad13956286543bf9ad96b89e50419a52" name="gga1a67c3beedf3da610b8c96abe49ac05aaad13956286543bf9ad96b89e50419a52"></a>EVENT_NOTIFY_WAITING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aafbc7782fce90f051b3bcb3f253c2c27a" name="gga1a67c3beedf3da610b8c96abe49ac05aafbc7782fce90f051b3bcb3f253c2c27a"></a>EVENT_NOTIFY_PENDING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aa4cf575f09ca098ca9ef15340587aa6a5" name="gga1a67c3beedf3da610b8c96abe49ac05aa4cf575f09ca098ca9ef15340587aa6a5"></a>EVENT_WAIT_PENDING&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aa0b6feb861ea3eb9fa8a1550d06ef78a9" name="gga1a67c3beedf3da610b8c96abe49ac05aa0b6feb861ea3eb9fa8a1550d06ef78a9"></a>EVENT_WAIT_SUSPEND&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aa4996db8ea61862f6dc96648e3c97f292" name="gga1a67c3beedf3da610b8c96abe49ac05aa4996db8ea61862f6dc96648e3c97f292"></a>EVENT_ISR_HANDLER&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="gga1a67c3beedf3da610b8c96abe49ac05aa0f68889b1009a9a0e10cfcb2511e5bb5" name="gga1a67c3beedf3da610b8c96abe49ac05aa0f68889b1009a9a0e10cfcb2511e5bb5"></a>EVENT_KERNEL_TICK&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gac035534b8e50ba8942b8e6956268180c" name="gac035534b8e50ba8942b8e6956268180c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac035534b8e50ba8942b8e6956268180c">&#9670;&#160;</a></span>trace_event()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trace_event </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="group__os__tracing.html#ga1a67c3beedf3da610b8c96abe49ac05a">TraceEventID</a>&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trace event. </p>
<p>This will trace event into trace buffer. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">event</td><td>The event that happened </td></tr>
    <tr><td class="paramname">arg</td><td>optional argument to the event, event-specific </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If trace buffer was not initialized then this call does nothing. Please mind that even then the call happens and consumes CPU cycles. </dd></dl>

</div>
</div>
<a id="ga098cdc49cfa2cfcfc59815e6978fddb8" name="ga098cdc49cfa2cfcfc59815e6978fddb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga098cdc49cfa2cfcfc59815e6978fddb8">&#9670;&#160;</a></span>trace_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool trace_init </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>start_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>end_addr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize trace buffer. </p>
<p>Trace buffer is usually put outside of the allocated RAM so it can occupy otherwise unused and unallocated RAM space. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_addr</td><td>start address of the trace buffer </td></tr>
    <tr><td class="paramname">end_addr</td><td>last usable address by the trace buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if trace buffer has been initialized. False is returned if trace buffer is already initialized. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</div>
</body>
</html>
