<!-- HTML header for doxygen 1.9.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>C Microkernel Realtime eXecutive: Communication abstraction</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="all">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">C Microkernel Realtime eXecutive
   </div>
   <div id="projectbrief">Realtime Operating System for Cortex-M based microcontrollers</div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__bsw__com.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Communication abstraction<div class="ingroups"><a class="el" href="group__libs.html">Libraries</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Communication abstraction offers transport-independent way of communication.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComNotificationVMT.html">ComNotificationVMT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interface of notification callback.  <a href="structComNotificationVMT.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComNotification.html">ComNotification</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComSourceVMT.html">ComSourceVMT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Methods implemented by the interface of class <a class="el" href="structComSource.html" title="Source - read end of simplex channel.">ComSource</a>.  <a href="structComSourceVMT.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComSource.html">ComSource</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Source - read end of simplex channel.  <a href="structComSource.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComSinkVMT.html">ComSinkVMT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Methods implemented by the interface of class <a class="el" href="structComSink.html" title="Sink - write end of simplex channel.">ComSink</a>.  <a href="structComSinkVMT.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComSink.html">ComSink</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sink - write end of simplex channel.  <a href="structComSink.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComChannelVMT.html">ComChannelVMT</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Methods implemented by the interface of class <a class="el" href="structComChannel.html" title="Channel - bidirectional communication channel.">ComChannel</a>.  <a href="structComChannelVMT.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structComChannel.html">ComChannel</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Channel - bidirectional communication channel.  <a href="structComChannel.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga0046e741f355150b05ac97f456e39482" id="r_ga0046e741f355150b05ac97f456e39482"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsw__com.html#ga0046e741f355150b05ac97f456e39482">COM_NOTIFICATION</a>(name,  argname)</td></tr>
<tr class="memdesc:ga0046e741f355150b05ac97f456e39482"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper macro for definition of notification callbacks.  <br /></td></tr>
<tr class="separator:ga0046e741f355150b05ac97f456e39482"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1861d01ee10efbd041270df16815a8db" id="r_ga1861d01ee10efbd041270df16815a8db"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__bsw__com.html#ga1861d01ee10efbd041270df16815a8db">foo</a> (int bar)</td></tr>
<tr class="separator:ga1861d01ee10efbd041270df16815a8db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Communication abstraction offers transport-independent way of communication. </p>
<p>Abstract mechanisms offered here cover one-way communication either as a producer or as a consumer and two-way communication. These mechanisms internally use CMRX RPC interfaces, thus actual implementation of communication interfaces is fully up to provider / consumer.</p>
<p>Main advantage of abstract communication interfaces is, that it is possible to change communication channel without need of changing higher layers of the software. This improves portability and reusability of the code.</p>
<p>You can use communication abstraction in a following way:</p>
<p>Depending on if your communication is uni- or bi-directional and what direction the data flows, choose from one of three interfaces offered here: <a class="el" href="structComSink.html" title="Sink - write end of simplex channel.">ComSink</a>, <a class="el" href="structComSource.html" title="Source - read end of simplex channel.">ComSource</a> or <a class="el" href="structComChannel.html" title="Channel - bidirectional communication channel.">ComChannel</a>. Each of these provides pre-defined virtual method table and very lean "virtual" class, which only publishes virtual method table itself. Therefore you are free to provide your own data members and means of how any of these interfaces is implemented.</p>
<p>Next, create your own interface using virtual method table of previously chosen interface, such as:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>MySourceImplementation {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code hl_struct" href="structComSourceVMT.html">ComSourceVMT</a> * vtable;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_member;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> my_member_two;</div>
<div class="line">};</div>
<div class="ttc" id="astructComSourceVMT_html"><div class="ttname"><a href="structComSourceVMT.html">ComSourceVMT</a></div><div class="ttdoc">Methods implemented by the interface of class ComSource.</div><div class="ttdef"><b>Definition</b> com.h:142</div></div>
</div><!-- fragment --><p>Next, if you create instance of this interface, you need to initialize the vtable of your interface. You can do it such as:</p>
<div class="fragment"><div class="line"><span class="comment">// declare, which class will actually be accessible from within methods</span></div>
<div class="line"><span class="preprocessor">#define CLASS struct MySourceImplementation</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// prototypes of methods of interface implementations</span></div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> my_source_read(SELF, uint8_t * data, <span class="keywordtype">unsigned</span> max_len);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span> my_source_ready(SELF);</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> my_source_set_notify(SELF, <span class="keyword">struct</span> <a class="code hl_struct" href="structComNotification.html">ComNotification</a> * listener, uint32_t <a class="code hl_function" href="group__api__signal.html#gaca5040b15e7a554d7d6a99a0b89efcd8">signal</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// map methods into slots of interface vtable</span></div>
<div class="line"><span class="keyword">static</span> <a class="code hl_define" href="group__api__init.html#gaa4a137442c139400b647ac62b40ea51a">VTABLE</a> <span class="keyword">struct </span><a class="code hl_struct" href="structComSourceVMT.html">ComSourceVMT</a> my_source_vtable = {</div>
<div class="line">    &amp;my_source_read,</div>
<div class="line">    &amp;my_source_ready,</div>
<div class="line">    &amp;my_source_set_notify</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// create interface instance</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>MySourceImplementation instance = {</div>
<div class="line">    &amp;my_source_vtable,</div>
<div class="line">    1,</div>
<div class="line">    2</div>
<div class="line">};</div>
<div class="ttc" id="agroup__api__init_html_gaa4a137442c139400b647ac62b40ea51a"><div class="ttname"><a href="group__api__init.html#gaa4a137442c139400b647ac62b40ea51a">VTABLE</a></div><div class="ttdeci">#define VTABLE</div><div class="ttdef"><b>Definition</b> application.h:31</div></div>
<div class="ttc" id="agroup__api__signal_html_gaca5040b15e7a554d7d6a99a0b89efcd8"><div class="ttname"><a href="group__api__signal.html#gaca5040b15e7a554d7d6a99a0b89efcd8">signal</a></div><div class="ttdeci">__SYSCALL int signal(int signo, void(*sighandler)(uint32_t))</div><div class="ttdoc">Register function as current thread signal handler.</div><div class="ttdef"><b>Definition</b> signal.c:4</div></div>
<div class="ttc" id="astructComNotification_html"><div class="ttname"><a href="structComNotification.html">ComNotification</a></div><div class="ttdef"><b>Definition</b> com.h:130</div></div>
</div><!-- fragment --><p>As you can see, You don't need to provide your own declaration of virtual method table. All you need to do is to provide your own methods to be filled into vtable of chosen interface. Another advantage of this approach is that you can pass instance of <code>MySourceImplementation</code> class whenever, when <a class="el" href="structComSource.html" title="Source - read end of simplex channel.">ComSource</a> is expected. This will work transparently. Methods you've provided will have access to full details of class <code>MySourceImplementation</code>, while caller will simply treat your class as if it was generic <code><a class="el" href="structComSource.html" title="Source - read end of simplex channel.">ComSource</a></code> class. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga0046e741f355150b05ac97f456e39482" name="ga0046e741f355150b05ac97f456e39482"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0046e741f355150b05ac97f456e39482">&#9670;&#160;</a></span>COM_NOTIFICATION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COM_NOTIFICATION</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">name, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">argname&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> __ ## name ## _handler(SELF, uint32_t argname);\</div>
<div class="line">\</div>
<div class="line"><span class="keyword">static</span> <a class="code hl_define" href="group__api__init.html#gaa4a137442c139400b647ac62b40ea51a">VTABLE</a> <span class="keyword">struct </span><a class="code hl_struct" href="structComNotificationVMT.html">ComNotificationVMT</a> name ## _vmt = {\</div>
<div class="line">    &amp;__ ## name ## _handler\</div>
<div class="line">};\</div>
<div class="line">\</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a class="code hl_struct" href="structComNotification.html">ComNotification</a> name = {\</div>
<div class="line">    &amp; name ## _vmt,\</div>
<div class="line">    0xFF\</div>
<div class="line">};\</div>
<div class="line">\</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span> __ ## name ## _handler(SELF, uint32_t argname)</div>
<div class="ttc" id="astructComNotificationVMT_html"><div class="ttname"><a href="structComNotificationVMT.html">ComNotificationVMT</a></div><div class="ttdoc">Interface of notification callback.</div><div class="ttdef"><b>Definition</b> com.h:125</div></div>
</div><!-- fragment -->
<p>Helper macro for definition of notification callbacks. </p>
<p>This macro defines all the stuff required for notification callback implementation. It defines virtual method table owned by the module and prototypes one method of this virtual method table. User can start defining body of this method directly after using macro.</p>
<p>Typical usage of this macro is:</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> uint32_t notified_channel;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="group__bsw__com.html#ga0046e741f355150b05ac97f456e39482">COM_NOTIFICATION</a>(my_notification, channel)</div>
<div class="line">{</div>
<div class="line">    notified_channel = channel;</div>
<div class="line">    ...wake up or start thread which handles notification...</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">....</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">// channel initialization code:</span></div>
<div class="line">    <a class="code hl_define" href="group__api__rpc.html#ga896b17abf6ce670f5000ac4a0852393f">rpc_call</a>(&amp;channel, set_notify, &amp;my_notification, channel_id);</div>
<div class="ttc" id="agroup__api__rpc_html_ga896b17abf6ce670f5000ac4a0852393f"><div class="ttname"><a href="group__api__rpc.html#ga896b17abf6ce670f5000ac4a0852393f">rpc_call</a></div><div class="ttdeci">#define rpc_call(service_instance, method_name,...)</div><div class="ttdoc">User-visible way to perform remote procedure call.</div><div class="ttdef"><b>Definition</b> rpc.h:112</div></div>
<div class="ttc" id="agroup__bsw__com_html_ga0046e741f355150b05ac97f456e39482"><div class="ttname"><a href="group__bsw__com.html#ga0046e741f355150b05ac97f456e39482">COM_NOTIFICATION</a></div><div class="ttdeci">#define COM_NOTIFICATION(name, argname)</div><div class="ttdoc">Helper macro for definition of notification callbacks.</div><div class="ttdef"><b>Definition</b> com.h:105</div></div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>name of interface instance usable in call to set_notify RPC call </td></tr>
    <tr><td class="paramname">argname</td><td>name of argument usable in body of notification handler </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga1861d01ee10efbd041270df16815a8db" name="ga1861d01ee10efbd041270df16815a8db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1861d01ee10efbd041270df16815a8db">&#9670;&#160;</a></span>foo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int foo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bar</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.7-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</div>
</body>
</html>
